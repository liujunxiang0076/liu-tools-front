<template>
  <div class="min-h-screen bg-base-200 py-4 md:py-8">
    <div class="container mx-auto px-4 max-w-5xl">
      <!-- жАхжЮбТаЄжбў -->
      <div class="mb-6 md:mb-8">
        <div class="flex items-center gap-2 md:gap-3 mb-3 md:mb-4">
          <button 
            @click="goBack"
            class="btn btn-ghost btn-circle touch-manipulation"
          >
            <svg class="w-4 h-4 md:w-5 md:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
            </svg>
          </button>
          <span class="text-2xl md:text-3xl">­ЪћЉ</span>
          <h1 class="text-xl md:text-2xl font-bold text-base-content">т»єуаЂућЪТѕљтЎе</h1>
        </div>
        <p class="text-sm md:text-base text-base-content/70 px-4 md:px-0">
          ућЪТѕљт«ЅтЁеуџёжџЈТю║т»єуаЂ№╝їтЈ»УЄфт«џС╣ЅжЋ┐т║дтњїтГЌугду▒╗тъІ№╝їуА«С┐Ют»єуаЂт╝║т║д
        </p>
      </div>

      <!-- т»єуаЂућЪТѕљУ«Йуй« -->
      <div class="mb-6 bg-base-100 rounded-2xl p-6 shadow-lg">
        <h2 class="text-lg font-semibold text-base-content mb-4">т»єуаЂУ«Йуй«</h2>
        
        <div class="space-y-6">
          <!-- т»єуаЂжЋ┐т║д -->
          <div>
            <label class="block text-sm font-medium text-base-content/70 mb-2">
              т»єуаЂжЋ┐т║д: {{ passwordLength }}
            </label>
            <div class="flex items-center gap-4">
              <input
                v-model="passwordLength"
                type="range"
                min="4"
                max="128"
                class="range range-primary flex-1"
                @input="generatePassword"
              >
              <input
                v-model="passwordLength"
                type="number"
                min="4"
                max="128"
                class="input input-bordered w-20 text-center"
                @input="generatePassword"
              >
            </div>
            <div class="flex justify-between text-xs text-base-content/60 mt-1">
              <span>4</span>
              <span>ТјеУЇљ: 12-16СйЇ</span>
              <span>128</span>
            </div>
          </div>

          <!-- тГЌугду▒╗тъІжђЅТІЕ -->
          <div>
            <label class="block text-sm font-medium text-base-content/70 mb-3">
              тГЌугду▒╗тъІ
            </label>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
              <label class="flex items-center gap-3 p-3 bg-base-200 rounded-lg cursor-pointer hover:bg-base-300 transition-colors">
                <input
                  v-model="charTypes.uppercase"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">тцДтєЎтГЌТ»Ї</div>
                  <div class="text-xs text-base-content/60">A-Z (26 СИфтГЌугд)</div>
                </div>
              </label>
              
              <label class="flex items-center gap-3 p-3 bg-base-200 rounded-lg cursor-pointer hover:bg-base-300 transition-colors">
                <input
                  v-model="charTypes.lowercase"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">т░ЈтєЎтГЌТ»Ї</div>
                  <div class="text-xs text-base-content/60">a-z (26 СИфтГЌугд)</div>
                </div>
              </label>
              
              <label class="flex items-center gap-3 p-3 bg-base-200 rounded-lg cursor-pointer hover:bg-base-300 transition-colors">
                <input
                  v-model="charTypes.numbers"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">ТЋ░тГЌ</div>
                  <div class="text-xs text-base-content/60">0-9 (10 СИфтГЌугд)</div>
                </div>
              </label>
              
              <label class="flex items-center gap-3 p-3 bg-base-200 rounded-lg cursor-pointer hover:bg-base-300 transition-colors">
                <input
                  v-model="charTypes.symbols"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">уЅ╣Т«ітГЌугд</div>
                  <div class="text-xs text-base-content/60">!@#$%^&* уГЅ</div>
                </div>
              </label>
            </div>
          </div>

          <!-- жФўу║ДжђЅжА╣ -->
          <div class="collapse collapse-arrow bg-base-200">
            <input type="checkbox" class="peer">
            <div class="collapse-title text-sm font-medium text-base-content/70">
              жФўу║ДжђЅжА╣
            </div>
            <div class="collapse-content space-y-4">
              <label class="flex items-center gap-3 cursor-pointer">
                <input
                  v-model="advancedOptions.excludeSimilar"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">ТјњжЎцуЏИС╝╝тГЌугд</div>
                  <div class="text-xs text-base-content/60">ТјњжЎц 0, O, l, I, 1 уГЅт«╣ТўЊТииТиєуџётГЌугд</div>
                </div>
              </label>
              
              <label class="flex items-center gap-3 cursor-pointer">
                <input
                  v-model="advancedOptions.excludeAmbiguous"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">ТјњжЎцТеАу│ітГЌугд</div>
                  <div class="text-xs text-base-content/60">ТјњжЎц {}, [], (), &lt;&gt;, ", ', ` уГЅ</div>
                </div>
              </label>
              
              <label class="flex items-center gap-3 cursor-pointer">
                <input
                  v-model="advancedOptions.noRepeating"
                  type="checkbox"
                  class="checkbox checkbox-primary"
                  @change="generatePassword"
                >
                <div class="flex-1">
                  <div class="font-medium text-base-content">ТЌажЄЇтцЇтГЌугд</div>
                  <div class="text-xs text-base-content/60">уА«С┐ЮТ»ЈСИфтГЌугдтЈфтЄ║уј░СИђТгА</div>
                </div>
              </label>
            </div>
          </div>

          <!-- ућЪТѕљТїЅжњ« -->
          <div class="flex gap-2">
            <button 
              @click="generatePassword"
              class="btn btn-primary flex-1"
              :disabled="!hasSelectedCharTypes"
            >
              <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
              </svg>
              жЄЇТќ░ућЪТѕљ
            </button>
            <button 
              @click="generateMultiplePasswords"
              class="btn btn-outline"
            >
              ТЅ╣жЄЈућЪТѕљ
            </button>
          </div>
        </div>
      </div>

      <!-- ућЪТѕљуџёт»єуаЂ -->
      <div class="mb-6 bg-base-100 rounded-2xl p-6 shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold text-base-content">ућЪТѕљуџёт»єуаЂ</h2>
          <div class="flex gap-2">
            <button 
              @click="copyPassword"
              class="btn btn-sm btn-primary"
              :disabled="!generatedPassword"
            >
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
              </svg>
              тцЇтѕХ
            </button>
          </div>
        </div>
        
        <div class="relative">
          <div class="p-4 bg-base-200 rounded-lg font-mono text-lg break-all min-h-[3rem] flex items-center">
            <span v-if="generatedPassword" class="text-base-content">{{ generatedPassword }}</span>
            <span v-else class="text-base-content/40 italic">уѓ╣тЄ╗ућЪТѕљт»єуаЂ</span>
          </div>
          
          <!-- т»єуаЂт╝║т║дТїЄуц║тЎе -->
          <div v-if="generatedPassword" class="mt-3">
            <div class="flex items-center justify-between mb-2">
              <span class="text-sm font-medium text-base-content/70">т»єуаЂт╝║т║д</span>
              <span :class="['text-sm font-medium', getStrengthColor(passwordStrength.score)]">
                {{ getStrengthText(passwordStrength.score) }}
              </span>
            </div>
            <div class="w-full bg-base-300 rounded-full h-2">
              <div 
                :class="['h-2 rounded-full transition-all duration-300', getStrengthColor(passwordStrength.score)]"
                :style="{ width: `${(passwordStrength.score / 4) * 100}%` }"
              ></div>
            </div>
          </div>
        </div>
      </div>

      <!-- т»єуаЂт╝║т║дтѕєТъљ -->
      <div v-if="generatedPassword" class="mb-6 bg-base-100 rounded-2xl p-6 shadow-lg">
        <h2 class="text-lg font-semibold text-base-content mb-4">т»єуаЂт╝║т║дтѕєТъљ</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
          <div class="p-4 bg-base-200 rounded-lg">
            <div class="text-sm font-medium text-base-content/70 mb-1">жЋ┐т║д</div>
            <div class="text-lg font-bold text-base-content">{{ generatedPassword.length }}</div>
          </div>
          
          <div class="p-4 bg-base-200 rounded-lg">
            <div class="text-sm font-medium text-base-content/70 mb-1">тГЌугдуДЇу▒╗</div>
            <div class="text-lg font-bold text-base-content">{{ passwordStrength.charTypes }}</div>
          </div>
          
          <div class="p-4 bg-base-200 rounded-lg">
            <div class="text-sm font-medium text-base-content/70 mb-1">уєхтђ╝</div>
            <div class="text-lg font-bold text-base-content">{{ passwordStrength.entropy.toFixed(1) }} bits</div>
          </div>
          
          <div class="p-4 bg-base-200 rounded-lg">
            <div class="text-sm font-medium text-base-content/70 mb-1">уа┤УДБТЌХжЌ┤</div>
            <div class="text-lg font-bold text-base-content">{{ passwordStrength.crackTime }}</div>
          </div>
        </div>
        
        <!-- т«ЅтЁет╗║У«« -->
        <div v-if="passwordStrength.suggestions.length > 0" class="mt-4 p-4 bg-warning/10 border border-warning/20 rounded-lg">
          <div class="text-sm font-medium text-warning mb-2">т«ЅтЁет╗║У««</div>
          <ul class="text-sm text-warning/80 space-y-1">
            <li v-for="suggestion in passwordStrength.suggestions" :key="suggestion" class="flex items-start gap-2">
              <span class="text-warning">Рђб</span>
              <span>{{ suggestion }}</span>
            </li>
          </ul>
        </div>
      </div>

      <!-- ТЅ╣жЄЈућЪТѕљуџёт»єуаЂ -->
      <div v-if="multiplePasswords.length > 0" class="mb-6 bg-base-100 rounded-2xl p-6 shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold text-base-content">ТЅ╣жЄЈућЪТѕљуџёт»єуаЂ</h2>
          <div class="flex gap-2">
            <button 
              @click="copyAllPasswords"
              class="btn btn-sm btn-primary"
            >
              тцЇтѕХтЁежЃе
            </button>
            <button 
              @click="clearMultiplePasswords"
              class="btn btn-sm btn-ghost"
            >
              ТИЁуЕ║
            </button>
          </div>
        </div>
        
        <div class="space-y-2 max-h-64 overflow-y-auto">
          <div v-for="(password, index) in multiplePasswords" :key="index" 
               class="flex items-center gap-3 p-3 bg-base-200 rounded-lg">
            <span class="text-sm text-base-content/60 w-6">{{ index + 1 }}.</span>
            <span class="flex-1 font-mono text-sm break-all">{{ password }}</span>
            <button 
              @click="copyPassword(password)"
              class="btn btn-xs btn-ghost"
            >
              тцЇтѕХ
            </button>
          </div>
        </div>
      </div>

      <!-- т»єуаЂтјєтЈ▓У«░тйЋ -->
      <div v-if="passwordHistory.length > 0" class="mb-6 bg-base-100 rounded-2xl p-6 shadow-lg">
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-semibold text-base-content">тјєтЈ▓У«░тйЋ</h2>
          <div class="flex gap-2">
            <button 
              @click="clearHistory"
              class="btn btn-sm btn-ghost"
            >
              ТИЁуЕ║тјєтЈ▓
            </button>
          </div>
        </div>
        
        <div class="space-y-2 max-h-48 overflow-y-auto">
          <div v-for="(item, index) in passwordHistory" :key="index" 
               class="flex items-center gap-3 p-3 bg-base-200 rounded-lg">
            <span class="flex-1 font-mono text-sm break-all">{{ item.password }}</span>
            <span class="text-xs text-base-content/60">{{ item.timestamp }}</span>
            <button 
              @click="copyPassword(item.password)"
              class="btn btn-xs btn-ghost"
            >
              тцЇтѕХ
            </button>
          </div>
        </div>
      </div>

      <!-- т»єуаЂт«ЅтЁеТЈљуц║ -->
      <div class="bg-base-100 rounded-2xl p-6 shadow-lg">
        <h2 class="text-lg font-semibold text-base-content mb-4">т»єуаЂт«ЅтЁеТЈљуц║</h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="space-y-3">
            <div class="flex items-start gap-3">
              <div class="w-2 h-2 bg-success rounded-full mt-2 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-base-content">Сй┐ућет╝║т»єуаЂ</div>
                <div class="text-sm text-base-content/70">УЄ│т░Љ12СйЇ№╝їтїЁтљФтцДт░ЈтєЎтГЌТ»ЇсђЂТЋ░тГЌтњїуЅ╣Т«ітГЌугд</div>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-2 h-2 bg-success rounded-full mt-2 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-base-content">Т»ЈСИфУ┤дТѕиСй┐ућеСИЇтљїт»єуаЂ</div>
                <div class="text-sm text-base-content/70">жЂ┐тЁЇт»єуаЂжЄЇтцЇСй┐уће№╝їжЎЇСйјт«ЅтЁежБјжЎЕ</div>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-2 h-2 bg-success rounded-full mt-2 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-base-content">т«џТюЪТЏ┤ТЇбт»єуаЂ</div>
                <div class="text-sm text-base-content/70">жЄЇУдЂУ┤дТѕит╗║У««Т»Ј3-6СИфТюѕТЏ┤ТЇбСИђТгАт»єуаЂ</div>
              </div>
            </div>
          </div>
          
          <div class="space-y-3">
            <div class="flex items-start gap-3">
              <div class="w-2 h-2 bg-warning rounded-full mt-2 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-base-content">Сй┐ућет»єуаЂу«АуљєтЎе</div>
                <div class="text-sm text-base-content/70">ТјеУЇљСй┐ућеСИЊСИџуџёт»єуаЂу«АуљєтиЦтЁи</div>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-2 h-2 bg-warning rounded-full mt-2 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-base-content">тљ»ућетЈїтЏау┤аУ«цУ»Ђ</div>
                <div class="text-sm text-base-content/70">СИ║жЄЇУдЂУ┤дТѕитљ»уће2FAтбът╝║т«ЅтЁеТђД</div>
              </div>
            </div>
            
            <div class="flex items-start gap-3">
              <div class="w-2 h-2 bg-error rounded-full mt-2 flex-shrink-0"></div>
              <div>
                <div class="font-medium text-base-content">жЂ┐тЁЇтюетЁгтЁ▒тю║ТЅђУЙЊтЁЦт»єуаЂ</div>
                <div class="text-sm text-base-content/70">Т│еТёЈжў▓УїЃУѓЕуфЦтњїжћ«уЏўУ«░тйЋтЎе</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup lang="ts">
import { ref, computed, reactive, watch } from 'vue'
import { useRouter } from 'vue-router'

const router = useRouter()

// тЊЇт║ћт╝ЈТЋ░ТЇ«
const passwordLength = ref(12)
const generatedPassword = ref('')
const multiplePasswords = ref<string[]>([])
const passwordHistory = ref<Array<{password: string, timestamp: string}>>([])

// тГЌугду▒╗тъІжђЅТІЕ
const charTypes = reactive({
  uppercase: true,
  lowercase: true,
  numbers: true,
  symbols: true
})

// жФўу║ДжђЅжА╣
const advancedOptions = reactive({
  excludeSimilar: false,
  excludeAmbiguous: false,
  noRepeating: false
})

// тГЌугджЏєт«џС╣Ѕ
const characterSets = {
  uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',
  lowercase: 'abcdefghijklmnopqrstuvwxyz',
  numbers: '0123456789',
  symbols: '!@#$%^&*()_+-=[]{}|;:,.<>?'
}

// уЏИС╝╝тГЌугдтњїТеАу│ітГЌугд
const similarChars = '0Ol1I'
const ambiguousChars = '{}[]()<>"\''

// У«Ау«Ќт▒ъТђД
const hasSelectedCharTypes = computed(() => {
  return Object.values(charTypes).some(selected => selected)
})

// т»єуаЂт╝║т║дтѕєТъљ
const passwordStrength = computed(() => {
  if (!generatedPassword.value) {
    return { score: 0, charTypes: 0, entropy: 0, crackTime: '', suggestions: [] }
  }
  
  const password = generatedPassword.value
  let score = 0
  let charTypeCount = 0
  const suggestions: string[] = []
  
  // ТБђТЪЦтГЌугду▒╗тъІ
  const hasUpper = /[A-Z]/.test(password)
  const hasLower = /[a-z]/.test(password)
  const hasNumber = /\d/.test(password)
  const hasSymbol = /[!@#$%^&*()_+\-=\[\]{}|;:,.<>?]/.test(password)
  
  if (hasUpper) charTypeCount++
  if (hasLower) charTypeCount++
  if (hasNumber) charTypeCount++
  if (hasSymbol) charTypeCount++
  
  // жЋ┐т║дУ»ётѕє
  if (password.length >= 12) score += 2
  else if (password.length >= 8) score += 1
  else suggestions.push('т»єуаЂжЋ┐т║дУЄ│т░Љт║ћСИ║8СйЇ')
  
  // тГЌугду▒╗тъІУ»ётѕє
  if (charTypeCount >= 3) score += 2
  else if (charTypeCount >= 2) score += 1
  else suggestions.push('т╗║У««Сй┐ућетцџуДЇтГЌугду▒╗тъІ')
  
  // У«Ау«Ќуєхтђ╝
  const charset = getCharacterSet()
  const entropy = password.length * Math.log2(charset.length)
  
  // У«Ау«Ќуа┤УДБТЌХжЌ┤
  const crackTime = calculateCrackTime(entropy)
  
  if (score < 2) suggestions.push('т╗║У««тбътіат»єуаЂжЋ┐т║дтњїтцЇТЮѓт║д')
  if (password.length < 12) suggestions.push('т╗║У««Сй┐ућеУЄ│т░Љ12СйЇтГЌугд')
  if (!hasSymbol) suggestions.push('т╗║У««тїЁтљФуЅ╣Т«ітГЌугд')
  
  return {
    score: Math.min(score, 4),
    charTypes: charTypeCount,
    entropy,
    crackTime,
    suggestions
  }
})

// У┐ћтЏъСИіСИђжАх
const goBack = () => {
  router.back()
}

// УјитЈќтГЌугджЏє
const getCharacterSet = (): string => {
  let charset = ''
  
  if (charTypes.uppercase) charset += characterSets.uppercase
  if (charTypes.lowercase) charset += characterSets.lowercase
  if (charTypes.numbers) charset += characterSets.numbers
  if (charTypes.symbols) charset += characterSets.symbols
  
  // ТјњжЎцуЏИС╝╝тГЌугд
  if (advancedOptions.excludeSimilar) {
    charset = charset.split('').filter(char => !similarChars.includes(char)).join('')
  }
  
  // ТјњжЎцТеАу│ітГЌугд
  if (advancedOptions.excludeAmbiguous) {
    charset = charset.split('').filter(char => !ambiguousChars.includes(char)).join('')
  }
  
  return charset
}

// ућЪТѕљт»єуаЂ
const generatePassword = () => {
  if (!hasSelectedCharTypes.value) {
    generatedPassword.value = ''
    return
  }
  
  const charset = getCharacterSet()
  if (charset.length === 0) {
    generatedPassword.value = ''
    return
  }
  
  let password = ''
  const usedChars = new Set<string>()
  
  // уА«С┐ЮУЄ│т░ЉтїЁтљФТ»ЈуДЇжђЅСИГуџётГЌугду▒╗тъІ
  const requiredChars: string[] = []
  if (charTypes.uppercase) requiredChars.push(getRandomChar(characterSets.uppercase))
  if (charTypes.lowercase) requiredChars.push(getRandomChar(characterSets.lowercase))
  if (charTypes.numbers) requiredChars.push(getRandomChar(characterSets.numbers))
  if (charTypes.symbols) requiredChars.push(getRandomChar(characterSets.symbols))
  
  // ТЅЊС╣▒т┐ЁжюђтГЌугдуџёжА║т║Ј
  const shuffledRequired = requiredChars.sort(() => Math.random() - 0.5)
  
  // ућЪТѕљт»єуаЂ
  for (let i = 0; i < passwordLength.value; i++) {
    let char: string
    
    if (i < shuffledRequired.length) {
      char = shuffledRequired[i]
    } else {
      do {
        char = getRandomChar(charset)
      } while (advancedOptions.noRepeating && usedChars.has(char))
    }
    
    if (advancedOptions.noRepeating) {
      usedChars.add(char)
    }
    
    password += char
  }
  
  // Тюђу╗ѕТЅЊС╣▒
  generatedPassword.value = password.split('').sort(() => Math.random() - 0.5).join('')
  
  // Ти╗тіатѕ░тјєтЈ▓У«░тйЋ
  addToHistory(generatedPassword.value)
}

// УјитЈќжџЈТю║тГЌугд
const getRandomChar = (charset: string): string => {
  return charset.charAt(Math.floor(Math.random() * charset.length))
}

// ТЅ╣жЄЈућЪТѕљт»єуаЂ
const generateMultiplePasswords = () => {
  const passwords: string[] = []
  for (let i = 0; i < 10; i++) {
    generatePassword()
    if (generatedPassword.value) {
      passwords.push(generatedPassword.value)
    }
  }
  multiplePasswords.value = passwords
}

// У«Ау«Ќуа┤УДБТЌХжЌ┤
const calculateCrackTime = (entropy: number): string => {
  // тЂЄУ«ЙТ»ЈуДњтЈ»С╗Цт░ЮУ»Ћ10^9ТгА
  const attemptsPerSecond = 1e9
  const totalCombinations = Math.pow(2, entropy)
  const averageAttempts = totalCombinations / 2
  const seconds = averageAttempts / attemptsPerSecond
  
  if (seconds < 60) return '< 1тѕєжњЪ'
  if (seconds < 3600) return `${Math.round(seconds / 60)}тѕєжњЪ`
  if (seconds < 86400) return `${Math.round(seconds / 3600)}т░ЈТЌХ`
  if (seconds < 31536000) return `${Math.round(seconds / 86400)}тцЕ`
  if (seconds < 31536000000) return `${Math.round(seconds / 31536000)}т╣┤`
  return '> 1000т╣┤'
}

// УјитЈќт╝║т║джбюУЅ▓
const getStrengthColor = (score: number): string => {
  switch (score) {
    case 0:
    case 1:
      return 'bg-error text-error'
    case 2:
      return 'bg-warning text-warning'
    case 3:
      return 'bg-info text-info'
    case 4:
      return 'bg-success text-success'
    default:
      return 'bg-base-300 text-base-content'
  }
}

// УјитЈќт╝║т║дТќЄТюг
const getStrengthText = (score: number): string => {
  switch (score) {
    case 0:
    case 1:
      return 'т╝▒'
    case 2:
      return 'СИГуГЅ'
    case 3:
      return 'т╝║'
    case 4:
      return 'тЙѕт╝║'
    default:
      return 'ТюфуЪЦ'
  }
}

// тцЇтѕХт»єуаЂ
const copyPassword = async (password?: string) => {
  const textToCopy = password || generatedPassword.value
  if (!textToCopy) return
  
  try {
    await navigator.clipboard.writeText(textToCopy)
    // тЈ»С╗ЦТи╗тіаТѕљтіЪТЈљуц║
  } catch (error) {
    console.error('тцЇтѕХтц▒У┤Ц:', error)
  }
}

// тцЇтѕХТЅђТюЅт»єуаЂ
const copyAllPasswords = async () => {
  if (multiplePasswords.value.length === 0) return
  
  const allPasswords = multiplePasswords.value.join('\n')
  try {
    await navigator.clipboard.writeText(allPasswords)
  } catch (error) {
    console.error('тцЇтѕХтц▒У┤Ц:', error)
  }
}

// ТИЁуЕ║ТЅ╣жЄЈт»єуаЂ
const clearMultiplePasswords = () => {
  multiplePasswords.value = []
}

// Ти╗тіатѕ░тјєтЈ▓У«░тйЋ
const addToHistory = (password: string) => {
  const timestamp = new Date().toLocaleString()
  passwordHistory.value.unshift({ password, timestamp })
  
  // жЎљтѕХтјєтЈ▓У«░тйЋТЋ░жЄЈ
  if (passwordHistory.value.length > 20) {
    passwordHistory.value = passwordHistory.value.slice(0, 20)
  }
}

// ТИЁуЕ║тјєтЈ▓У«░тйЋ
const clearHistory = () => {
  passwordHistory.value = []
}

// уЏЉтљгтЈўтїќ№╝їУЄфтіеућЪТѕљт»єуаЂ
watch([passwordLength, charTypes, advancedOptions], () => {
  if (hasSelectedCharTypes.value) {
    generatePassword()
  }
}, { deep: true })

// тѕЮтДІтїќ
generatePassword()
</script>

<style scoped>
/* тЊЇт║ћт╝ЈУ░ЃТЋ┤ */
@media (max-width: 768px) {
  .range {
    height: 1.5rem;
  }
}
</style> 
